$(document).ready(function(){function e(){var e="";_.each(a.models,function(t){e+='<li id="'+t.get("_id")+'"class="list-group-item"><span class="theText">'+t.get("text")+'</span><a href="#" class="delete btn btn-danger btn-xs pull-right"><i class="fa fa-remove"></i></a><a href="#" class="edit btn btn-info btn-xs pull-right"><i class="fa fa-edit"></i></a></li>'}),$("#todoList").html(e)}function t(e){var t=e;$.ajax({url:"/api/todos/"+e,type:"DELETE",success:function(){$("#"+t).remove(),$.bootstrapGrowl("Item successfully removed.",{type:"success",align:"center",width:"auto",allow_dismiss:!0})},error:function(e){$.bootstrapGrowl(e.responseText,{type:"danger",align:"center",width:"auto",allow_dismiss:!0})}})}Todo=Backbone.Model.extend({idAttribute:"_id"}),Todos=Backbone.Collection.extend({url:"/api/todos",model:Todo});var a=new Todos;a.fetch({success:function(){e()},error:function(e){$.bootstrapGrowl(e.responseText,{type:"danger",align:"center",width:"auto",allow_dismiss:!1})}}),a.on("add",function(e){console.log("New todo created",e)}),$("#form").submit(function(e){return e.preventDefault(),a.create({text:$("input").val().trim()}),!1}),$("ul").on("click",".delete",function(e){var a=$(e.currentTarget).parent().attr("id");t(a)}),$("ul").on("click",".edit",function(e){var t=$(e.currentTarget);"undefined"!=typeof t.parent().children("span").attr("contenteditable")?$.ajax({url:"/api/todos/"+t.parent().attr("id"),type:"PUT",data:{text:t.parent().children("span").text()},success:function(){t.parent().children("span").removeAttr("contenteditable"),t.removeClass("btn-success").addClass("btn-info"),t.children("i").removeClass("fa-save").addClass("fa-edit"),$.bootstrapGrowl("Successfully updated.",{type:"success",align:"center",width:"auto",allow_dismiss:!1})},error:function(e){$.bootstrapGrowl(e.responseText,{type:"danger",align:"center",width:"auto",allow_dismiss:!1})}}):(t.parent().children("span").attr("contenteditable",!0),t.removeClass("btn-info").addClass("btn-success"),t.children("i").removeClass("fa-edit").addClass("fa-save"))})});